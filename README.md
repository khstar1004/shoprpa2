# ShopRPA - 해오름기프트 가격비교 RPA 시스템

ShopRPA는 해오름기프트 상품을 고려기프트 및 네이버쇼핑과 자동으로 비교하여 최저가 정보를 제공하는 RPA(Robotic Process Automation) 시스템입니다. 비기술적 사용자도 쉽게 사용할 수 있도록 설계되었습니다.

## 기능 소개

- **자동 크롤링**: 해오름기프트 상품 정보를 기반으로 고려기프트와 네이버쇼핑에서 관련 상품을 자동으로 검색합니다.
- **정밀 매칭**: 텍스트 및 이미지 유사도 분석을 통해 90% 이상의 정확도로 동일 상품을 식별합니다.
- **가격 비교**: 매칭된 상품 간의 가격 차이를 계산하여 최저가 정보를 추출합니다.
- **결과 보고서**: 가격 불량 상품(본사보다 낮은 가격으로 판매중인 상품)을 엑셀 형식으로 정리하여 제공합니다.
- **사용자 친화적 UI**: 직관적인 인터페이스로 비기술적 사용자도 쉽게 사용할 수 있습니다.

## 시스템 요구사항

- **운영체제**: Windows 10 이상
- **메모리**: 최소 8GB RAM, 권장 16GB 이상
- **저장공간**: 최소 2GB 이상 여유공간
- **인터넷 연결**: 필수 (크롤링 작업을 위함)

## 상세 설치 가이드

### 1. Python 설치하기

1. [Python 공식 웹사이트](https://www.python.org/downloads/)에서 Python 3.9 이상을 다운로드합니다.
2. 설치 파일을 실행하고 반드시 "**Add Python to PATH**" 옵션을 체크합니다.
   ![Python 설치 화면](https://www.pythontutorial.net/wp-content/uploads/2020/10/Python-Download-Windows-Installer.jpg)
3. "Install Now"를 클릭하여 설치를 진행합니다.
4. 설치가 완료되면 명령 프롬프트(CMD)를 열고 `python --version`을 입력하여 설치가 제대로 되었는지 확인합니다.

### 2. ShopRPA 프로그램 설치하기

1. 제공된 ShopRPA 파일을 원하는 위치(예: C:\ShopRPA)에 압축 해제합니다.
2. 명령 프롬프트(CMD)를 **관리자 권한**으로 실행합니다. (Windows 검색에서 'cmd'를 입력 후 마우스 오른쪽 버튼 클릭 → '관리자 권한으로 실행')
3. ShopRPA 폴더로 이동합니다:
   ```
   cd C:\ShopRPA
   ```
4. 필요한 라이브러리를 설치합니다:
   ```
   pip install -r requirements.txt
   ```
5. Playwright 브라우저를 설치합니다:
   ```
   python -m playwright install
   ```

### 3. 필수 디렉토리 구조 설정하기

다음 디렉토리 구조를 C 드라이브에 생성합니다:

```
C:\RPA\
├── Input\          # 입력 파일 저장 디렉토리
├── Output\         # 결과 파일 저장 디렉토리
├── Temp\           # 임시 파일 저장 디렉토리
└── Image\
    ├── Main\       # 해오름기프트 이미지 저장 디렉토리
    └── Target\     # 고려기프트/네이버 이미지 저장 디렉토리
```

디렉토리 생성을 위해 명령 프롬프트에서 다음 명령어를 실행합니다:

```
mkdir C:\RPA
mkdir C:\RPA\Input
mkdir C:\RPA\Output
mkdir C:\RPA\Temp
mkdir C:\RPA\Image
mkdir C:\RPA\Image\Main
mkdir C:\RPA\Image\Target
```

## 프로그램 사용 방법

### 1. 입력 파일 준비하기

입력 파일은 Excel(.xlsx) 형식이어야 하며 다음 **필수 열**을 포함해야 합니다:

- **구분**: 'A'(승인관리) 또는 'P'(가격관리)
- **담당자**: 담당자명
- **업체명**: 업체 이름
- **업체코드**: 업체 고유 코드
- **상품Code**: 상품 고유 코드 (필수)
- **중분류카테고리**: 상품 카테고리
- **상품명**: 상품명 (필수)
- **기본수량(1)**: 기본 수량
- **판매단가(V포함)**: 판매 가격 (필수)
- **본사상품링크** 또는 **본사 이미지**: 제품 이미지 URL (필수)

준비된 입력 파일은 **C:\RPA\Input** 폴더에 저장하세요.

### 2. GUI 프로그램 실행하기

1. ShopRPA 폴더에서 `shoprpa_gui.py` 파일을 더블클릭하거나 명령 프롬프트에서 다음 명령어를 실행합니다:
   ```
   python PythonScript/shoprpa_gui.py
   ```
2. ShopRPA 그래픽 인터페이스가 열립니다.

### 3. 분석 작업 실행하기

1. **파일 선택**: "파일 찾기" 버튼을 클릭하여 C:\RPA\Input 폴더에서 준비한 입력 파일을 선택합니다.

2. **설정 조정**:
   - **처리 유형**: 승인관리(A) 또는 가격관리(P) 중 선택
   - **텍스트 매칭 임계값**: 상품명 유사도 기준 (0.5~0.9, 기본값: 0.55)
   - **이미지 매칭 임계값**: 이미지 유사도 기준 (0.4~0.8, 기본값: 0.5)
   - **GPU 사용**: 가능한 경우 체크 (속도 향상)

3. **실행**: "시작" 버튼을 클릭하여 RPA 프로세스를 실행합니다.
   - 진행 상황이 하단 상태 바와 로그 탭에 표시됩니다.

4. **결과 확인**: 처리가 완료되면 결과 파일이 자동으로 생성되고 열립니다.
   - 결과 파일은 C:\RPA\Output 폴더에 저장됩니다.

### 4. 고급 설정 (선택 사항)

설정 탭에서 다음과 같은 고급 옵션을 조정할 수 있습니다:
- **동시 처리 작업 수**: 크롤링 및 매칭 동시 작업 수
- **배경 제거 사용**: 이미지 비교 전 배경 제거 여부
- **크롤링 최대 결과 수**: 검색당 최대 결과 수
- **네트워크 타임아웃**: 크롤링 요청 타임아웃 설정
- **디렉토리 경로**: 입출력 및 이미지 저장 경로

## 결과 해석하기

결과 파일은 두 가지 형식으로 제공됩니다:

1. **상세 결과 파일** (이미지 포함):
   - 해오름기프트 정보(코드, 이름, 가격)
   - 매칭된 고려기프트/네이버 상품 정보
   - 가격 차이 및 차이 비율(%)
   - 색상 코드:
     - **빨간색**: 심각한 가격 불량 (차이 15% 이상)
     - **주황색**: 경미한 가격 불량 (차이 5-15%)
     - **녹색**: 정상 가격 (차이 5% 미만)

2. **업로드용 파일** (이미지 없음):
   - 동일한 정보가 포함된 경량 버전 (이미지 제외)

## 문제 해결 가이드

### 자주 발생하는 문제와 해결책

| 문제 | 해결 방법 |
|------|----------|
| 프로그램이 실행되지 않음 | Python이 제대로 설치되었는지 확인<br>필요 라이브러리가 모두 설치되었는지 확인 |
| "입력 파일을 찾을 수 없습니다" | 파일이 C:\RPA\Input 폴더에 있는지 확인 |
| "필수 열이 누락되었습니다" | 입력 파일 형식 확인 (필수 열 포함 여부) |
| 이미지가 처리되지 않음 | 입력 파일의 이미지 URL이 유효한지 확인 |
| 크롤링 오류 | 인터넷 연결 확인<br>방화벽 설정 확인 |
| 메모리 부족 오류 | 다른 프로그램 종료 후 재시도<br>처리 데이터 양 축소 |

### 로그 확인하기

문제 발생 시 다음 로그 파일을 확인하세요:
- `PythonScript/shoprpa_log.txt`
- `shoprpa_gui.log`

### 설정 초기화하기

설정 문제가 의심될 경우:
1. `PythonScript/ClearUserConfigData.py` 실행
2. 프로그램 재시작

## 실행 팁

- **입력 데이터 품질**: 정확한 상품명과 고품질 이미지는 매칭 정확도를 높입니다.
- **배치 처리**: 대량 데이터는 여러 작은 배치로 나누어 처리하는 것이 효율적입니다.
- **정기적인 임시 파일 정리**: C:\RPA\Temp 폴더를 주기적으로 비워주세요.
- **새 버전 확인**: 프로그램을 정기적으로 업데이트하여 최신 크롤링 패턴을 적용하세요.

## 명령줄 모드 (고급 사용자용)

GUI 대신 명령줄로 실행하려면:
```
python PythonScript/main_rpa.py --cli
```

## 기술 정보

- **텍스트 분석**: Sentence-BERT(ko-sroberta-multitask)
- **이미지 분석**: EfficientNetB0, SIFT
- **크롤링**: Playwright
- **GUI**: PyQt5

## 라이선스

이 프로젝트는 내부 사용 목적으로 개발되었으며, 무단 배포 및 사용을 금지합니다. 