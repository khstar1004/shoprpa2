# ShopRPA - 해오름기프트 가격비교 RPA 시스템

ShopRPA는 해오름기프트 상품을 고려기프트 및 네이버쇼핑과 자동으로 비교하여 최저가 정보를 제공하는 RPA(Robotic Process Automation) 시스템입니다.

## 기능 소개

- **자동 크롤링**: 해오름기프트 상품 정보를 기반으로 고려기프트와 네이버쇼핑에서 관련 상품을 자동으로 검색합니다.
- **정밀 매칭**: 텍스트 및 이미지 유사도 분석을 통해 90% 이상의 정확도로 동일 상품을 식별합니다.
- **가격 비교**: 매칭된 상품 간의 가격 차이를 계산하여 최저가 정보를 추출합니다.
- **결과 보고서**: 가격 불량 상품(본사보다 낮은 가격으로 판매중인 상품)을 엑셀 형식으로 정리하여 제공합니다.
- **사용자 친화적 UI**: 비기술적 사용자도 쉽게 사용할 수 있는 직관적인 인터페이스를 제공합니다.

## 시스템 요구사항

- Windows 10 이상
- Python 3.9 이상
- 최소 8GB RAM, 권장 16GB 이상
- 인터넷 연결

## 설치 방법

### 1. Python 설치

먼저 [Python 공식 웹사이트](https://www.python.org/downloads/)에서 Python 3.9 이상을 다운로드하여 설치합니다.

### 2. 필요 라이브러리 설치

명령 프롬프트(cmd)를 열고 다음 명령어를 실행합니다:

```
pip install -r requirements.txt
```

### 3. 디렉토리 구조 설정

다음 디렉토리 구조를 생성합니다:

```
C:\RPA\
├── Input\          # 입력 파일을 저장하는 디렉토리
├── Output\         # 결과 파일이 저장되는 디렉토리
├── Temp\           # 임시 파일 저장 디렉토리
└── Image\
    ├── Main\       # 해오름기프트 이미지 저장 디렉토리
    └── Target\     # 고려기프트/네이버 이미지 저장 디렉토리
```

## 사용 방법

### GUI 모드로 실행

1. `shoprpa_gui.py` 파일을 실행합니다:
   ```
   python shoprpa_gui.py
   ```

2. 메인 화면에서 '파일 찾기' 버튼을 클릭하여 입력 파일을 선택합니다.

3. 처리 유형(승인관리 또는 가격관리)과 유사도 임계값을 설정합니다.

4. '시작' 버튼을 클릭하여 RPA 프로세스를 실행합니다.

5. 처리가 완료되면 결과 파일이 자동으로 열립니다.

### 명령줄 모드로 실행

```
python main_rpa.py
```

## 입력 파일 형식

입력 파일은 Excel(.xlsx) 형식이며 다음 열을 포함해야 합니다:

- 구분 (A 또는 P)
- 담당자
- 업체명
- 업체코드
- 상품Code
- 중분류카테고리
- 상품명
- 기본수량(1)
- 판매단가(V포함)
- 본사상품링크
- 본사 이미지

## 출력 파일 형식

출력 파일은 가격 불량 상품(본사보다 가격이 낮은 상품)만 추출하여 다음 정보를 포함합니다:

- 해오름기프트 정보 (상품코드, 상품명, 가격 등)
- 고려기프트 가격 정보 및 링크
- 네이버쇼핑 가격 정보 및 링크
- 가격 차이 및 차이 비율(%)

## 문제 해결

문제가 발생한 경우:

1. 로그 탭에서 오류 메시지를 확인합니다.
2. `shoprpa_log.txt` 및 `shoprpa_gui.log` 파일을 확인합니다.
3. 필요한 디렉토리가 모두 생성되었는지 확인합니다.
4. 입력 파일 형식이 올바른지 확인합니다.

## 개발 정보

- **텍스트 분석**: Sentence-BERT(ko-sroberta-multitask)
- **이미지 분석**: EfficientNetB0
- **크롤링**: Playwright
- **GUI**: PyQt5

## 라이선스

이 프로젝트는 내부 사용 목적으로 개발되었으며, 무단 배포 및 사용을 금지합니다. 